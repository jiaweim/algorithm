# 后缀数组

## 简介

假设 $s$ 是长度为 $n$ 的字符串。那么 $s$ 的第 $i$ 个后缀为 $s[i...n-1]$。

将字符串的所有后缀的起始索引按字符串顺序排序，就获得**后缀数组**（suffix array）。

以字符串 $s=abaab$ 为例，其后缀为：

| 起始索引 | 后缀 |
| ---- | ---- |
| 0 | abaab |
| 1 | baab |
| 2 | aab |
| 3 | ab |
| 4 | b |
按索引排序：

| 起始索引 | 后缀 |
| ---- | ---- |
| 2 | aab |
| 3 | ab |
| 0 | abaab |
| 4 | b |
| 1 | baab |
因此，后缀数组为 `(2, 3, 0, 4, 1)`。

作为一个数据结构，后缀数组在数据压缩、生物信息学以及字符串处理和匹配问题中有着广泛引用。

## 构建

### $O(n^2logn)$ 方法

这是最直观的做法。即获得所有后缀，然后通过 quicksort 或 mergesort 进行排序，同时保留原始索引。排序需要 $O(nlogn)$ 次比较，而比较两个字符串选哟 $O(n)$ 时间，因此最终复杂度为 $O(n^2logn)$。

### $O(nlogn)$ 方法




## 参考

- https://cp-algorithms.com/string/suffix-array.html